---
interface Props {
    direction?: 'up' | 'down' | 'left' | 'right';
    delay?: number;
    duration?: number;
    class?: string;
}

const {
    direction = 'up',
    delay = 0,
    duration = 0.6,
    class: className = ''
} = Astro.props;

const id = `slide-in-${Math.random().toString(36).substr(2, 9)}`;

const initialTransforms = {
    up: 'translateY(30px)',
    down: 'translateY(-30px)',
    left: 'translateX(30px)',
    right: 'translateX(-30px)'
};

const initialTransform = initialTransforms[direction];
---

<div
    id={id}
    class={`slide-in-wrapper ${className}`}
    style={`opacity: 0; transform: ${initialTransform}; transition-delay: ${delay}s; transition-duration: ${duration}s;`}
>
    <slot />
</div>

<script define:vars={{ id }}>
    // Intersection Observer for scroll-triggered slide-in
    const element = document.getElementById(id);

    if (element) {
        const observer = new IntersectionObserver(
            (entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translate(0, 0)';
                        observer.unobserve(entry.target);
                    }
                });
            },
            {
                threshold: 0.1,
                rootMargin: '0px 0px -100px 0px'
            }
        );

        observer.observe(element);
    }
</script>

<style>
    .slide-in-wrapper {
        transition-property: opacity, transform;
        transition-timing-function: ease-out;
    }
</style>
